<!doctype html>
<html>
<head>
<title></title>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen" />
<style>
body {
  padding: 0;
  margin: 0;
}
#box {
  margin-top: 50px;
  width: 700px;
  border: 1px solid #AAA;
  margin: auto;
  height: 300px;
}
#code {
  width: 520px;
  margin: auto;
}
.clear {
  clear: both;
}
.line {
  width: 5px;
  height: 140px;
  background-color: green;
  border: 1px solid #AAA;
  box-shadow: 1px 1px 2px #CCC;
  float: left;
  margin-top: 50px;
}
.active {
  background-color: yellow;
}
.red {
  background-color: red;
}
</style>
</head>
<body>
  <div id="box"></div>
  <div id="code">
    <pre><code>
/* 排序动画 */
let quickSort = function (left, right) {
  var pivotpos, err
  if left < right {
    let err, pivotpos = await partition(left, right)
    await quickSort(left, pivotpos - 1)
    await quickSort(pivotpos + 1, right)
  }
  console.log(left, right);
}
await quickSort(0, data.length - 1)
    </code></pre>
  </div>
</body>
</html>
<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
<script src="../bright.min.js"></script>
<script>
/* 此代码用于绘制图像 */
var COUNT = 100;
var UNIT_HEIGHT = 4;
var randomArray = function (length) {
  var array = [];
  for (var i = 1; i < length; i++) {
    array.push(i);
  }
  array.sort(function () {
    return (Math.round(Math.random()) - 0.5);
  });
  return array;
};
var data = randomArray(COUNT + 1);
var $box = $('#box');
var setHeight = function (i) {
  var d = data[i];
  $('#line-' + i).css({
    'margin-top': ((COUNT - d) * UNIT_HEIGHT) + 'px',
    'height':     (d * UNIT_HEIGHT) + 'px'
  });
};
var html = '';
data.forEach(function (d, i) {
  html += '<div class="line" id="line-' + i + '"></div>';
});
html += '<div class="clear"></div>';
$box.html(html).height(COUNT * UNIT_HEIGHT + 20);
data.forEach(function (d, i) {
  setHeight(i);
});

/* 交换两个数 */
var $line = $('.line');
var swap = function (a, b) {
  var tmp = data[a];
  data[a] = data[b];
  data[b] = tmp;
  setHeight(a);
  setHeight(b);
}
/* 激活指定数 */
var active = function (a, b, c) {
  $line.removeClass('active').removeClass('red');
  $('#line-' + a).addClass('active');
  $('#line-' + b).addClass('active');
  $('#line-' + c).addClass('red');
}
/* 产生随机数 */
var rand = function () {
  return parseInt(Math.random() * COUNT * 10);
};
</script>
<script type="text/bright">
/* 排序动画 */
var quickSort, partition
/* 对数据区间[left..right]进行划分 */
let partition = function (left, right) {
  var rnd = rand() % (right - left + 1) + left
  swap(rnd, right)
  var pvt = right
  var i = left - 1
  var j = i + 1
  for j < right {
    active(i, j, pvt);
    sleep 50
    if data[j] < data[pvt] {
      swap(j, ++i)
    }
    j++
  }
  swap(++i, pvt)
  return i
}
/* 对数据区间[left..right]进行排序 */
let quickSort = function (left, right) {
  var pivotpos, err
  if left < right {
    let err, pivotpos = await partition(left, right)
    await quickSort(left, pivotpos - 1)
    await quickSort(pivotpos + 1, right)
  }
  console.log(left, right);
}
await quickSort(0, data.length - 1)
console.log(data);

$line.removeClass('active').removeClass('red');
alert('OK');
</script>